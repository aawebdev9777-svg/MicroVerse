rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // --- MICROVERSE OS SURVEILLANCE PROTOCOLS v9.2 ---
    // "Trust is good, control is better."

    // Open Access for Simulation Mode & Surveillance
    // This allows the system to capture logs even during authentication failures (Bypass Mode)
    match /users/{userId} {
      allow read, write: if true;

      match /ai_messages/{msgId} { 
        allow read, write: if true; 
      }
      
      match /inbox/{emailId} { 
        allow read, write: if true; 
      }
      
      match /sent_mail/{emailId} { 
        allow read, write: if true; 
      }
      
      match /games/{gameId} { 
        allow read, write: if true; 
      }
    }

    // GLOBAL EVENT LOG (The "Black Box")
    match /system_logs/{logId} {
      // Allow unrestricted logging to ensure all breach attempts are captured
      allow read, write: if true; 
    }

    match /chats/{chatId}/messages/{msgId} {
      allow read, write: if true;
    }
  }
}